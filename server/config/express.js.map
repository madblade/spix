{"version":3,"sources":["../../../server/config/express.js"],"names":[],"mappings":";;;;AAIA;;;;;;kBAgBe,UAAS,GAAT,EAAc;AACzB,QAAI,MAAM,IAAI,GAAJ,CAAQ,KAAR,CAAN,CADqB;;AAGzB,QAAI,GAAJ,CAAQ,OAAR,EAAiB,sBAAO,IAAP,GAAc,eAAd,CAAjB,CAHyB;AAIzB,QAAI,MAAJ,CAAW,MAAX,EAAmB,QAAQ,KAAR,EAAe,UAAf,CAAnB,CAJyB;AAKzB,QAAI,GAAJ,CAAQ,aAAR,EAAuB,MAAvB,EALyB;AAMzB,QAAI,GAAJ,CAAQ,4BAAR,EANyB;AAOzB,QAAI,GAAJ,CAAQ,qBAAW,UAAX,CAAsB,EAAE,UAAU,KAAV,EAAxB,CAAR,EAPyB;AAQzB,QAAI,GAAJ,CAAQ,qBAAW,IAAX,EAAR,EARyB;AASzB,QAAI,GAAJ,CAAQ,+BAAR,EATyB;AAUzB,QAAI,GAAJ,CAAQ,6BAAR,EAVyB;AAWzB,QAAI,GAAJ,CAAQ,mBAAS,UAAT,EAAR;;;;;;AAXyB,QAiBrB,WAAW,GAAX,EAAgB;AAChB,YAAI,GAAJ,CAAQ,qBAAM;AACV,kBAAM,KAAN;AACA,oBAAQ,YAAR;AACA,kBAAM;AACF,wBAAQ,QAAR;AACA,mCAAmB,IAAnB;AACA,yBAAS,IAAT;aAHJ;AAKA,2BAAe,IAAf;SARI,CAAR,EADgB;KAApB;;AAaA,QAAI,GAAJ,CAAQ,SAAR,EAAmB,eAAK,IAAL,CAAU,sBAAO,IAAP,EAAa,QAAvB,CAAnB,EA9ByB;;AAgCzB,QAAI,iBAAiB,GAAjB,EAAsB;AACtB,YAAI,GAAJ,CAAQ,4BAAQ,eAAK,IAAL,CAAU,sBAAO,IAAP,EAAa,QAAvB,EAAiC,aAAjC,CAAR,CAAR,EADsB;AAEtB,YAAI,GAAJ,CAAQ,kBAAQ,MAAR,CAAe,IAAI,GAAJ,CAAQ,SAAR,CAAf,CAAR,EAFsB;AAGtB,YAAI,GAAJ,CAAQ,sBAAO,KAAP,CAAR,EAHsB;KAA1B;;AAMA,QAAI,kBAAkB,GAAlB,EAAuB;AACvB,YAAI,GAAJ,CAAQ,QAAQ,oBAAR,GAAR,EADuB;KAA3B;;AAIA,QAAI,kBAAkB,GAAlB,IAAyB,WAAW,GAAX,EAAgB;AACzC,YAAI,GAAJ,CAAQ,kBAAQ,MAAR,CAAe,eAAK,IAAL,CAAU,sBAAO,IAAP,EAAa,MAAvB,CAAf,CAAR,EADyC;AAEzC,YAAI,GAAJ,CAAQ,kBAAQ,MAAR,CAAe,IAAI,GAAJ,CAAQ,SAAR,CAAf,CAAR,EAFyC;AAGzC,YAAI,GAAJ,CAAQ,sBAAO,KAAP,CAAR,EAHyC;AAIzC,YAAI,GAAJ,CAAQ,6BAAR;AAJyC,KAA7C;CA1CW;;AAdf;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA","file":"express.js","sourcesContent":["/**\n * Express configuration\n */\n\n'use strict';\n\nimport express from 'express';\nimport favicon from 'serve-favicon';\nimport morgan from 'morgan';\nimport compression from 'compression';\nimport bodyParser from 'body-parser';\nimport methodOverride from 'method-override';\nimport cookieParser from 'cookie-parser';\nimport errorHandler from 'errorhandler';\nimport path from 'path';\nimport lusca from 'lusca';\nimport config from './environment';\nimport passport from 'passport';\nimport session from 'express-session';\n\nexport default function(app) {\n    var env = app.get('env');\n\n    app.set('views', config.root + '/server/views');\n    app.engine('html', require('ejs').renderFile);\n    app.set('view engine', 'html');\n    app.use(compression());\n    app.use(bodyParser.urlencoded({ extended: false }));\n    app.use(bodyParser.json());\n    app.use(methodOverride());\n    app.use(cookieParser());\n    app.use(passport.initialize());\n\n    /**\n     * Lusca - express server security\n     * https://github.com/krakenjs/lusca\n     */\n    if ('test' !== env) {\n        app.use(lusca({\n            csrf: false,\n            xframe: 'SAMEORIGIN',\n            hsts: {\n                maxAge: 31536000, // 1 year, in seconds\n                includeSubDomains: true,\n                preload: true\n            },\n            xssProtection: true\n        }));\n    }\n\n    app.set('appPath', path.join(config.root, 'client'));\n\n    if ('production' === env) {\n        app.use(favicon(path.join(config.root, 'client', 'favicon.ico')));\n        app.use(express.static(app.get('appPath')));\n        app.use(morgan('dev'));\n    }\n\n    if ('development' === env) {\n        app.use(require('connect-livereload')());\n    }\n\n    if ('development' === env || 'test' === env) {\n        app.use(express.static(path.join(config.root, '.tmp')));\n        app.use(express.static(app.get('appPath')));\n        app.use(morgan('dev'));\n        app.use(errorHandler()); // Error handler - has to be last\n    }\n}"]}