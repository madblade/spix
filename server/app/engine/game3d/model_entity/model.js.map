{"version":3,"sources":["../../../../../../server/app/engine/game3d/model_entity/model.js"],"names":[],"mappings":";;;;AAIA;;;;;;;;;;;;;;;;;;AAEA;;;;AACA;;;;;;IAEM;AAEF,aAFE,WAEF,CAAY,IAAZ,EAAkB;4CAFhB,aAEgB;;AACd,aAAK,KAAL,GAAa,IAAb;;;;AADc,YAKd,CAAK,SAAL,GAAiB,mBAAjB,CALc;KAAlB;;+BAFE;;gCAYM,UAAU;AACd,gBAAI,WAAW,KAAK,SAAL,CADD;AAEd,qBAAS,OAAT,CAAiB,UAAC,MAAD,EAAS,EAAT,EAAgB;AAC7B,yBAAS,MAAT,EAD6B;aAAhB,CAAjB,CAFc;;;;oCAON,GAAG;AACX,gBAAI,WAAW,KAAK,SAAL,CADJ;AAEX,gBAAI,aAAa,KAAK,KAAL,CAAW,UAAX,CAFN;AAGX,gBAAI,KAAK,sBAAe,UAAf,CAA0B,QAA1B,CAAL,CAHO;AAIX,cAAE,MAAF,GAAW,kBAAc,YAAd,CAA2B,EAA3B,EAA+B,IAA/B,CAAX;;;AAJW,gBAOP,QAAQ,WAAW,QAAX,EAAR,CAPO;AAQX,cAAE,MAAF,CAAS,KAAT,CAAe,MAAM,eAAN,EAAf,EAAwC,MAAM,OAAN,CAAxC,CARW;;AAUX,qBAAS,GAAT,CAAa,EAAb,EAAiB,EAAE,MAAF,CAAjB,CAVW;;;;qCAaF,UAAU;AACnB,iBAAK,SAAL,CAAe,MAAf,CAAsB,QAAtB,EADmB;;;;;;;4CAKH,GAAG,GAAG,GAAG;AACzB,gBAAI,WAAW,KAAK,SAAL,CADU;AAEzB,gBAAI,SAAS,KAAT,CAFqB;AAGzB,qBAAS,OAAT,CAAiB,UAAC,MAAD,EAAS,EAAT,EAAgB;AAC7B,oBAAI,IAAI,OAAO,QAAP,CADqB;AAE7B,oBAAI,EAAE,CAAF,KAAQ,CAAR,IAAa,EAAE,CAAF,KAAQ,IAAE,CAAF,IAAO,EAAE,CAAF,KAAQ,CAAR,IAAa,EAAE,CAAF,KAAQ,IAAE,CAAF,IAAO,EAAE,CAAF,KAAQ,CAAR,IAAa,EAAE,CAAF,KAAQ,IAAE,CAAF,EAC7E,SAAS,IAAT,CADJ;aAFa,CAAjB,CAHyB;;AASzB,mBAAO,MAAP,CATyB;;;;4BA3Bd;AAAE,mBAAO,KAAK,SAAL,CAAT;;;WAVb;;;kBAkDS","file":"model.js","sourcesContent":["/**\n *\n */\n\n'use strict';\n\nimport EntityFactory from './factory';\nimport CollectionUtil from '../../math/collections';\n\nclass EntityModel {\n\n    constructor(game) {\n        this._game = game;\n\n        // Objects.\n        // TODO [MEDIUM] accessor: LACKS.\n        this._entities = new Map();\n    }\n\n    get entities() { return this._entities; }\n\n    forEach(callback) {\n        let entities = this._entities;\n        entities.forEach((entity, id) => {\n            callback(entity);\n        });\n    }\n\n    spawnPlayer(p) {\n        let entities = this._entities;\n        let worldModel = this._game.worldModel;\n        let id = CollectionUtil.generateId(entities);\n        p.avatar = EntityFactory.createAvatar(id, this);\n\n        // TODO [MEDIUM] custom spawn world and location.\n        let world = worldModel.getWorld();\n        p.avatar.spawn(world.getFreePosition(), world.worldId);\n\n        entities.set(id, p.avatar);\n    }\n\n    removePlayer(playerId) {\n        this._entities.delete(playerId);\n    }\n\n    // TODO [MEDIUM] optimize with LACKS structure.\n    anEntityIsPresentOn(x, y, z) {\n        let entities = this._entities;\n        let result = false;\n        entities.forEach((entity, id) => {\n            let p = entity.position;\n            if (p[0] >= x && p[0] <= x+1 && p[1] >= y && p[1] <= y+1 && p[2] >= z && p[2] <= z+1)\n                result = true;\n        });\n\n        return result;\n    }\n}\n\nexport default EntityModel;\n"]}