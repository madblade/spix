{"version":3,"sources":["../../../../../../../server/app/engine/game3d/engine_consistency/generator/generator.js"],"names":[],"mappings":";;;;AAIA;;;;;;;;;;;;;;;;;;;;;;AAEA;;;;AACA;;;;;;IAEM;AAEF,aAFE,SAEF,CAAY,iBAAZ,EAA+B;4CAF7B,WAE6B;;AAC3B,aAAK,WAAL,GAAmB,kBAAkB,UAAlB,CADQ;KAA/B;;+BAFE;;wCAMc;;AAEZ,gBAAI,QAAQ,KAAK,WAAL,CAAiB,QAAjB,EAAR;;;AAFQ,mBAKL,sBAAY,mBAAW;;;AAG1B,oBAAI,IAAI,MAAM,KAAN;oBAAa,IAAI,MAAM,KAAN;oBAAa,IAAI,MAAM,KAAN,CAHhB;AAI1B,oBAAI,WAAW,yBAAe,iBAAf,CAAiC,CAAjC,EAAoC,CAApC,EAAuC,CAAvC,EAA0C,KAA1C,CAAX;;;AAJsB,qBAO1B,CAAM,SAAN,GAAkB,QAAlB;;;AAP0B,oBAUtB,SAAS,kBAAQ,QAAR,CAAT;;AAVsB,sBAY1B,CAAO,OAAP,CAAe,UAAC,KAAD,EAAQ,EAAR;2BAAe,yBAAa,iBAAb,CAA+B,KAA/B;iBAAf,CAAf;;;AAZ0B,uBAe1B,GAf0B;aAAX,CAAnB,CALY;;;WANd;;;kBAgCS","file":"generator.js","sourcesContent":["/**\n * Create and fill chunks.\n */\n\n'use strict';\n\nimport WorldGenerator       from './worldgenerator';\nimport ChunkBuilder         from '../builder/builder_chunks';\n\nclass Generator {\n\n    constructor(consistencyEngine) {\n        this._worldModel = consistencyEngine.worldModel;\n    }\n\n    generateWorld() {\n        // TODO [MEDIUM] generate distinct worlds.\n        let world = this._worldModel.getWorld();\n\n        // TODO [LOW] chrono and time out.\n        return new Promise(resolve => {\n\n            // Generate blocks.\n            let x = world.xSize, y = world.ySize, z = world.zSize;\n            var chunkMap = WorldGenerator.generateFlatWorld(x, y, z, world);\n\n            // Affect chunks.\n            world.allChunks = chunkMap;\n\n            // Finalize chunks (extract surface faces).\n            var chunks = new Map(chunkMap); // Shallow copy.\n            // Adds chunks in worldModel, so mutable chunkMapCollection does not fit.\n            chunks.forEach((chunk, id) => ChunkBuilder.computeChunkFaces(chunk));\n\n            // Notify\n            resolve();\n        });\n    }\n\n}\n\nexport default Generator;\n"]}